{% extends "dashboard/section.html" %}
{% set title = 'Bon de commande' %}
{% block main %}
<div class="row">
    <div class="pad margin no-print">
      <div class="callout callout-info" style="margin-bottom: 0!important;">
        <h4><i class="fa fa-info"></i> Note:</h4>
        Cette page a été optimisée pour l'impression. Cliquez sur le bouton d'impression au bas de la page pour imprimer votre bon de commande.
      </div>
    </div>

    <section class="invoice">
      <!-- title row -->
      <div class="row">
        <div class="col-xs-12">
          <h2 class="page-header">
            <i class="fa fa-globe"></i> Forum Organisation.
            <small class="pull-right">Date: {% now 'local', '%d/%m/%Y' %}</small>
          </h2>
        </div>
        <!-- /.col -->
      </div>
      <!-- info row -->
      <div class="row invoice-info">
        <div class="col-sm-4 invoice-col">
          De
          <address>
            <strong>Forum Organisation.</strong><br>
            20 Avenue Albert Einstein<br>
            Villeurbanne, 69100<br>
            Tel: 04 78 94 29 30<br>
            Email: contact-fra@forumorg.org
          </address>
        </div>
        <!-- /.col -->
        <div class="col-sm-4 invoice-col">
          À
          <address>
            <strong>{{ company.name }}</strong><br>
            <a href="#" id="address" data-type="address" data-pk="1" data-title="Adresse de facturation." class="editable editable-click" style="display: inline;"></a>
          </address>
        </div>
        <!-- /.col -->
        <div class="col-sm-4 invoice-col">
          <b>Bon de commande</b><br>
          <br>
          <b>Paiement avant:</b> 10/03/2017<br>
        </div>
        <!-- /.col -->
      </div>
      <!-- /.row -->

      {% if company.sections.equipement.furniture.items() %}
      <div class="box-header">
        <h3 class="box-title">Liste des équipements</h3>
      </div>
      <div class="row">
        <div class="col-xs-12 table-responsive">
            <table class="table table-striped">
                <thead>
                <tr>
                  <th>Produit</th>
                  <th>Quantité</th>
                  <th>Sous-total</th>
                </tr>
                </thead>
                <tbody>
                {% for k,v in company.sections.equipement.furniture.items() %}
                <tr>
                  <td>{{ k }}</td>
                  <td>{{ v }}</td>
                  <td>{{ make_price(k, v) }} €</td>
                </tr>
                {% endfor %}
                </tbody>
             </table>
        </div>
      </div>
      {% endif %}

      {% if company.sections.restauration.dishes.mercredi != 0 or company.sections.restauration.dishes.jeudi != 0 %}
      <div class="box-header">
        <h3 class="box-title">Liste des repas</h3>
      </div>
      <div class="row">
        <div class="col-xs-12 table-responsive">
            <table class="table table-striped">
                <thead>
                <tr>
                  <th>Jour</th>
                  <th>Nombre de repas</th>
                  <th>Sous-total</th>
                </tr>
                </thead>
                <tbody>
                {% for k,v in company.sections.restauration.dishes.items() %}
                {% if v != 0 %}
                <tr>
                  <td>{{ k|capitalize }}</td>
                  <td>{{ v }}</td>
                  <td>{{ v*20 }} €</td>
                </tr>
                {% endif %}
                {% endfor %}
                </tbody>
             </table>
        </div>
      </div>
      {% endif %}

      {% if company.sections.programme.events.conference.registered or company.sections.programme.events.networking.registered %}
      <div class="box-header">
        <h3 class="box-title">Liste des évènements</h3>
      </div>
      <div class="row">
        <div class="col-xs-12 table-responsive">
            <table class="table table-striped">
                <thead>
                <tr>
                  <th>Nom de l'évènement</th>
                  <th>Sous-total</th>
                </tr>
                </thead>
                <tbody>
                {% for k,v in company.sections.programme.events.items() %}
                {% if v.registered %}
                <tr>
                  <td>{{ v.name }}</td>
                  <td>{{ v.price }} €</td>
                </tr>
                {% endif %}
                {% endfor %}
                </tbody>
             </table>
        </div>
      </div>
      {% endif %}

      <div class="row">
        <!-- accepted payments column -->
        <div class="col-xs-6">
          <p class="lead">Méthodes de paiement:</p>
          <img src="{{ url_for('static', filename='images/cheque.png') }}" alt="Chèque">

          <p class="text-muted well well-sm no-shadow" style="margin-top: 10px;">
            Envoyer un chèque à notre adresse.
          </p>
        </div>
        <!-- /.col -->
        <div class="col-xs-6">
          <p class="lead">Montant dû 10/3/2017</p>

          <div class="table-responsive">
            <table class="table">
              <tbody><tr>
                <th style="width:50%">Sous-total (€)</th>
                <td>250.30</td>
              </tr>
              <tr>
                <th>T.V.A</th>
                <td><span class="text-muted">L'association n'étant pas assujettie à la TVA, nos prix sont nets de taxes (TTC).</span></td>
              </tr>
              <tr>
                <th>Total (€)</th>
                <td>265.24</td>
              </tr>
            </tbody></table>
          </div>
        </div>
        <!-- /.col -->
      </div>
      <!-- /.row -->

      <!-- this row will not appear when printing -->
      <div class="row no-print">
        <div class="col-xs-12">
          <a href="javascript:window.print()" target="_blank" class="btn btn-default pull-right"><i class="fa fa-print"></i> Imprimer Bon de commande</a>
        </div>
      </div>
    </section>
</div>
{% endblock main %}
{% block scripts %}
<script type="text/javascript">
    $('#address').editable({
        mode : "inline",
        value: {
            address: "", 
            town: "",
            country: "",
        },
        validate: function(value) {
            if(!(value.address && value.town && value.country)) return 'veuillez remplir tous les champs.'; 
        },
        display: function(value) {
            if (!(value.address && value.town && value.country)) {
                $(this).html("Aucune adresse enregistrée.");
                return;
            }
            var html = '<span '
              value.address + '<br>'
            + value.town + '<br>'
            + value.country + '<br>';

            $(this).html(html); 
        }         
    }); 
</script>
{% endblock scripts %}